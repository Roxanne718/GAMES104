# 引擎架构分层

## 游戏引擎的结构：分层架构

自上而下（5+1）：

- 工具层（tool layer）：做游戏的各种工具
- 功能层（function layer）：物理建模、角色行为、人机交互
- 资源层（resource layer）：音频、动画
- 核心层（core layer）：内存分配、线程管理等被频繁调用的函数
- 平台层（platform layer）：平台无关性

以上这些都有很成熟的第三方平台提供服务

### 重点
1. 游戏引擎是分层架构
2. 越上层越灵活，越底层越稳定
3. 虚拟世界是由tick构成的

---

## Tool Layer

1. 材质编辑器等
2. 开发灵活

## Function layer

1.  tick：游戏中的最小时间片段
```
    tickLogic()：物理运动逻辑
    tickRender(): 根据相机视角渲染
```

2. 多线程

## Resource layer：管理资源的生命周期

1. 把资源文件（包含很多建模时的冗余信息）变为资产（引擎化），GUID是资源ID
2. 定义资产之间的关系
3. handle系统
4. **做好垃圾回收！（gc）**


## Core Layer

1. 数学加速
2. 内存管理（重写一些数据结构，避免内存碎片等）
   - 尽可能把数据放到一起
   - 尽可能顺序访问
   - 尽可能一起读写（删除数据不要逐个删除，而是一次删除一批）

## Platform Layer

平台层负责抹掉不同平台底层的差异
